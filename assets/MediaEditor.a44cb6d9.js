import{d as Pe,r as w,l as Se,w as z,m as r,n as h,p as D,j as n,aT as b,s as c,G as $e,v as B,U as M,bb as Y,Q as S,H as V,x as f,F as O,y as ee,bt as ie,aV as ne,q as ae}from"./index.4f390c6a.js";import{Q as de}from"./QSelect.8ad877e3.js";import{Q as re}from"./QBadge.2339051b.js";import{Q as De}from"./QImg.a4aaed75.js";import{Q as Be}from"./QForm.c09e6959.js";import{Q as Ne}from"./QPage.e32daf6c.js";import{u as Oe}from"./use-quasar.4e14d354.js";import{Q as me}from"./QFile.0b5cf431.js";import{U as Ce,u as pe,d as Je}from"./cloudDB.d318324a.js";import{_ as Me}from"./UpdatedDate.47641b74.js";import{_ as xe}from"./CollectionSelect.2d35001e.js";import{b as Qe,m as ce}from"./locale-options.a93a5ee4.js";import{m as G,a as Te,p as Ee,c as Re,s as ve,S as ze}from"./constant.a3c7e21e.js";import{u as je}from"./SearchKey.a606d0cd.js";import"./QChip.17ac3977.js";import"./QItemLabel.95b24a48.js";import"./QMenu.75c03351.js";import"./selection.1482bdb7.js";import"./rtl.0738a96b.js";import"./format.6396bb17.js";import"./axios.ea5872bc.js";import"./date.865a2574.js";import"./index.d9f23821.js";import"./index.4024674e.js";const Ie={class:"row col justify-between"},Ae={class:"col-3"},Le=["src"],Ye={class:"col-9 q-pl-md"},Ge={class:"row col justify-between"},He={class:"row col justify-between"},Ke={class:"row col justify-between"},Ze={key:1,class:"q-mb-sm",style:{border:"1px solid lightgrey",borderRadius:"5px"}},We={class:"q-ma-sm row justify-between"},Xe={class:"q-mb-lg row col justify-between"},ea={key:2,class:"q-mb-md q-pa-sm row flex-center"},aa={id:"vp1",preload:"auto",controls:"",style:{width:"100%",height:"auto"}},la=["src"],oa={key:3,class:"q-mb-md",style:{border:"1px solid lightgrey",borderRadius:"5px"}},sa={key:0,class:"q-pa-sm row justify-between"},ua={class:"col-5"},ta={key:0,class:"q-mb-sm row justify-between"},ia={class:"q-gutter-md"},na={key:0,class:"q-mb-md q-py-sm"},da={key:0,class:"row flex-center"},ra={id:"audioPlayer",class:"q-pl-sm",controls:""},ma=["src","type"],pa={key:1,class:"row flex-center"},ca={id:"videoPlayer",width:"426",height:"300",controls:""},va=["src","type"],fa={key:2,class:"row flex-center"},ya={key:3,class:"q-pa-sm"},ga={class:"q-ma-sm row justify-between"},ba={class:"row justify-between"},Ia=Pe({__name:"MediaEditor",setup(_a){const H=Oe(),x=je(),q=w("Submit"),fe=w("https://www.youtube.com/embed/k3_tw44QsZQ?rel=0"),_=w({poster:null,media:null}),K=w(null),Z=w(""),C=w(""),Q=w(""),y=w("media"),J=w(!1),T=w(!0),U={media:{name:"",producer:"",poster:{url:""},alias:"",duration:18e4,category:"",language:"",speed:[],params:[]},speed:{start:"",end:"",tempo:0,time_signature:""},params:{url:"",type:"",name:"",duration:0,ffplay:"",ffmpeg:"",fs_id:0,file:null}},e=w(JSON.parse(JSON.stringify(U)));let d;const i={speed:-1,params:-1},t=w({audio:null,video:null,duration:0,currentTime:"",isPlaying:!1,files:[null,null]}),E=Ce.getInstance();Se(()=>{x.isEnable||x.toggleEnable(),x.isShow&&x.toggleShow()}),z(()=>t.value.currentTime,o=>{if(o){const l=o.replace(/\s/g,""),u=/^\d{1,2}:\d{1,2}:\d{1,2}$/.test(l)||/^\d{1,2}:\d{1,2}$/.test(l)||/^[1-5]?[0-9]$/.test(l)?Ee(l):0;t.value.audio&&(t.value.audio.currentTime=u),t.value.video&&(t.value.video.currentTime=u)}}),z(()=>_.value.poster,o=>{y.value="media",console.log("watch selectedFile.poster:",_.value),console.log("watch formData.value.media:",e.value.media),o&&e.value.media.poster&&(e.value.media.poster.url=URL.createObjectURL(o),console.log("watch formData.value.media.poster.url:",e.value.media.poster.url))}),z(()=>e.value.media.language,o=>{if(o){const l=ce.find(a=>a.value===o);l?C.value!==l.label&&(Q.value=`img:${l.image}`,C.value=l.label):(Q.value="",C.value="")}},{immediate:!0}),z(()=>C.value,o=>{if(o){const l=ce.find(a=>a.label===o);l?e.value.media.language!==l.value&&(Q.value=`img:${l.image}`,e.value.media.language=l.value):(Q.value="",e.value.media.language="")}},{immediate:!0}),z(()=>e.value.media.category,o=>{if(typeof o=="string"){const l=Re.find(a=>a.name===o);Z.value=l&&l.icon!==Z.value?l.icon:""}},{immediate:!0});function ye(){K.value&&K.value.pickFiles()}function ge(o){var l,a,u;o?o._id!==e.value.media._id&&(d=o,e.value.media=JSON.parse(JSON.stringify(o)),(l=e.value.media.poster)!=null&&l.url||(e.value.media.poster={url:""}),i.speed=0,(a=e.value.media.speed)!=null&&a.length||(e.value.media.speed=[{...U.speed}]),e.value.speed=e.value.media.speed[i.speed],i.params=0,(u=e.value.media.params)!=null&&u.length||(e.value.media.params=[{...U.params}]),e.value.params=e.value.media.params[i.params],console.log("onRestorePosterUrl formData.value.media:",e.value.media),_.value&&(_.value={poster:null,media:null}),!e.value.media.created_at&&e.value.media.updated_at&&(e.value.media.created_at=e.value.media.updated_at),q.value="Update"):(d=o,e.value.media=JSON.parse(JSON.stringify(U.media)),q.value="Submit")}async function be(o){const{params:l}=e.value.media;if(l&&l.length){const{url:a}=l[o];if(a&&a.length&&!a.includes("blob:http")&&a.includes("http")){try{const g=await E.request("uploadFiles/info",{query:{fileList:JSON.stringify([a])}});console.log("onMediaUrlPicked res:",g)}catch(g){console.error("onMediaUrlPicked err:",g),console.warn("onMediaUrlPicked error: url is not valid for uniCloud.")}const u=a.split(".com/")[1].split("/"),s="audio",p=u[1].split(".")[1];let v=p;p==="m4a"?v="x-m4a":p==="weba"?v="webm":p==="mp3"?v="mpeg":v="webm",l[o].type=`${s}/${v}`,l[o].name=u[1],l[o].file=null,t.value.files[o]=null,await ve(100),console.log("onMediaUrlPicked player.value:",t.value),le(s)}}}async function _e(o){if(console.log("onMediaFilePicked file.name:",o.name),y.value="params",console.log("onMediaFilePicked formData.value.media:",e.value.media),o&&e.value.params){e.value.params.url=URL.createObjectURL(o),e.value.params.name=o.name,e.value.params.type=o.type;const l=o.type.split("/")[0];(l==="audio"||l==="video")&&(await ve(100),t.value.files[i.params]=o,le(l))}}function le(o){t.value[o]=o==="audio"?document.getElementById(`${o}Player`):document.getElementById(`${o}Player`);const l=t.value[o];if(l){const a=Math.floor(l.duration)*ze;a>t.value.duration&&(t.value.duration=a),console.log("watch mediaPlayer.duration:",l.duration),l.load()}}function he(){var o,l,a,u;t.value.isPlaying?(t.value.isPlaying=!1,(o=t.value.audio)==null||o.pause(),(l=t.value.video)==null||l.pause()):(t.value.isPlaying=!0,(a=t.value.audio)==null||a.play(),(u=t.value.video)==null||u.play())}function Ve(){t.value.audio&&(t.value.audio.pause(),t.value.audio.currentTime=0),t.value.video&&(t.value.video.pause(),t.value.video.currentTime=0),t.value.isPlaying=!1}function qe(){if(console.log("onRestorePosterUrl formData.value.media:",e.value.media),e.value.media.poster){const o=d==null?void 0:d.poster;console.log("onRestorePosterUrl media.poster:",o),e.value.media.poster=o?JSON.parse(JSON.stringify(o)):{url:""},_.value.poster=null}}function oe(){var o;_.value.poster=null,(o=e.value.media.poster)!=null&&o.url&&(e.value.media.poster.url="")}function we(){if(console.log("onRestorePosterUrl formData.value.params:",e.value.params),d!=null&&d.params){const o=d.params;console.log("onRestorePosterUrl media.params:",o),e.value.params.url=o?o[i.params].url:"";const l=e.value.params.file;if(l){const a=l.type.split("/")[0];(a==="audio"||a==="video")&&(t.value[a]=null),t.value.isPlaying=!1,e.value.params.file=null}}}function se(){if(e.value.params){e.value.params.url="",e.value.params.file&&(e.value.params.file=null,t.value.files[i.params]=null);const l=e.value.params.type.split("/")[0];(l==="audio"||l==="video")&&(t.value[l]=null),t.value.isPlaying=!1,t.value.currentTime=""}}function R(){console.log("onMediaFocus"),y.value="media"}function j(){console.log("onMediaBlur formData.value.media",e.value.media)}function I(o){console.log("onSpeedFocus i:",o),y.value="speed"}function A(o){console.log("onSpeedBlur :"),o>=0&&e.value.media.speed&&console.log(`onSpeedBlur formData.value.media.speed[${o}]:`,e.value.media.speed[o])}function L(o){var l;console.log("onParamsFocus i:",o),y.value="params",i.params>=0&&((l=e.value.media.params)==null?void 0:l.length)&&(i.params=o,e.value.params=e.value.media.params[o])}function W(o){var l;o>=0&&((l=e.value.media.params)==null?void 0:l.length)&&(console.log(`onParamsBlur formData.value.media.params[${o}]:`,e.value.media.params[o]),console.log("onParamsBlur formData.value.params:",e.value.params))}function ue(){y.value==="media"?q.value==="Submit"?e.value.media=JSON.parse(JSON.stringify(U.media)):q.value==="Update"&&(e.value.media=JSON.parse(JSON.stringify(d)),e.value.media.speed&&(e.value.speed=e.value.media.speed[i.speed]),e.value.media.params&&(e.value.params=e.value.media.params[i.speed])):y.value==="speed"||y.value}async function Fe(){console.log("onSubmit formData:",e.value.media);let o=`${q.value} Media: ${e.value.media.name} _ ${e.value.media.producer} ?`;const l=[{label:"Cancel",color:"white",handler:()=>{}}],a=e.value.media._id?{_id:e.value.media._id}:{name:e.value.media.name,producer:e.value.media.producer},u={label:"Yes",color:"yellow",handler:async()=>{var k,te;e.value.media.speed&&e.value.media.speed.forEach(m=>m.tempo=Number(m.tempo));const s=Date.now(),p={...e.value.media,_id:void 0,updated_at:s};if(p.created_at||(p.created_at=s),T.value||(p.speed=void 0),J.value||(p.params=void 0),console.log("onSubmit body:",p),_.value.poster){const m=(k=d==null?void 0:d.poster)==null?void 0:k.url;let F="",P;if(m&&!m.includes("blob:http")&&(P=m),F=await pe(_.value.poster,P),F&&e.value.media.poster&&(_.value.poster=null,e.value.media.poster.url=F,P)){const $=d==null?void 0:d.poster;$&&($.url=F)}}if(e.value.media.params){for(let m=0;m<e.value.media.params.length;m++)if(e.value.media.params[m].file){let F="",P;if((te=d==null?void 0:d.params)!=null&&te.length){const N=d.params;if(N&&N.length>m){const X=N[m].url;X&&!X.includes("blob:http")&&(P=X)}}const $=e.value.media.params[m].file;F=await pe($,P),F&&e.value.media.params[m]&&(e.value.media.params[m].file=null,e.value.media.params[m].url=F,P&&d&&(d.params?d.params.length==m&&d.params.push(e.value.media.params[m]):d.params=[e.value.media.params[m]]))}}const v=e.value.media.params;if(v&&d)for(let m=0;m<v.length;m++){const F=v[m].file;let P="";const $=d.params;if(F&&$&&$[m]){P=$[m].url;const N=await Je(F,P);N&&(v[m].file=void 0,v[m].url=N,$[m].url=N)}}const g=await E.request("databaseCRUD/update",{query:{collection:"pcf-media",condition:JSON.stringify(a)},body:JSON.stringify(p)});console.log("onSubmit res:",g),(g.affectedDocs>0||g.id)&&(e.value.media.created_at||(e.value.media.created_at=p.created_at),e.value.media.updated_at=p.updated_at,q.value==="Submit"?(g.id&&(e.value.media._id=g.id),q.value="Update"):q.value==="Update"&&(d=JSON.parse(JSON.stringify(e.value.media))))}};l.push(u),H.notify({type:"positive",icon:"cloud_done",position:"center",timeout:0,message:o,actions:l})}function Ue(){const o=`Add a new ${y.value} ?`,l=[{label:"Cancel",color:"white",handler:()=>{}}],a={label:"Yes",color:"yellow",handler:()=>{q.value="Submit",ue()}};y.value==="speed"?a.handler=()=>{if(e.value.media.speed){const u={...U.speed};i.speed<0||e.value.media.speed.length===1?(e.value.media.speed.push(u),i.speed=e.value.media.speed.length-1):(e.value.media.speed.splice(++i.speed,0,u),i.speed++),e.value.speed=e.value.media.speed[i.speed]}}:y.value==="params"&&(a.handler=()=>{if(e.value.media){const u={...U.params};console.log("onAdd defaultForm.params:",U.params),e.value.media.params&&(i.params<0||e.value.media.params.length===1?(e.value.media.params.push(u),i.params=e.value.media.params.length-1,console.log("onAdd params push:",u)):(e.value.media.params.splice(++i.params,0,u),console.log("onAdd params splice:",u)),e.value.params=e.value.media.params[i.params])}}),l.push(a),H.notify({type:"positive",position:"center",icon:"add_circle",timeout:0,message:o,actions:l})}function ke(){const o=[{label:"Cancel",color:"white",handler:()=>{}}];let l=`Delete ${e.value.media.name} ?`;const a=e.value.media._id?{_id:e.value.media._id}:{name:e.value.media.name,producer:e.value.media.producer},u={label:"Yes",color:"yellow",handler:async()=>{if(e.value.media&&(q.value="Update")){const s=await E.request("databaseCRUD/delete",{query:{collection:"pcf-media",condition:JSON.stringify(a)}});console.log("onDelete Media res:",s),s.deleted===1&&d&&(x.key=d.alias?d.alias:"z")}}};y.value==="speed"?(l=`Delete Speed ${i.speed} ?`,u.handler=async()=>{var s,p,v;if(e.value.media&&i.speed>=0&&e.value.media.speed){if(e.value.media.speed.length===1)e.value.media.speed=[JSON.parse(JSON.stringify(U.speed))],e.value.speed=e.value.media.speed[0],i.speed=0;else if(e.value.media._id){console.log("onDelete condition:",a);const g={start:e.value.speed.start,end:e.value.speed.end};console.log("onDelete body:",g);const k=await E.request("databaseCRUD/arrayUpdate",{query:{collection:"pcf-media",field:y.value,method:"remove",condition:JSON.stringify(a)},body:JSON.stringify(g)});console.log("onDelete Event res:",k),k.affectedDocs===1&&k.updated===1&&((s=e.value.media.speed)==null||s.splice(i.speed,1),i.speed>((p=e.value.media.speed)==null?void 0:p.length)-1&&(i.speed=((v=e.value.media.speed)==null?void 0:v.length)-1))}}}):y.value==="params"&&(l=`Delete Params ${i.params} ?`,u.handler=async()=>{var s,p,v;if(e.value.media&&i.params>=0&&e.value.media.params){if(e.value.media.params.length===1)e.value.media.params=[JSON.parse(JSON.stringify(U.params))],e.value.params=e.value.media.params[0],i.params=0;else if(e.value.media._id){console.log("onDelete condition:",a);const g={url:e.value.params.url,type:e.value.params.type};console.log("onDelete body:",g);const k=await E.request("databaseCRUD/arrayUpdate",{query:{collection:"pcf-media",field:y.value,method:"remove",condition:JSON.stringify(a)},body:JSON.stringify(g)});console.log("onDelete Event res:",k),k.affectedDocs===1&&k.updated===1&&((s=e.value.media.speed)==null||s.splice(i.params,1),i.params>((p=e.value.media.params)==null?void 0:p.length)-1&&(i.params=((v=e.value.media.params)==null?void 0:v.length)-1))}}}),o.push(u),H.notify({type:"negative",position:"center",timeout:0,message:l,actions:o})}return(o,l)=>(r(),h(Ne,{padding:"",class:"q-ma-md"},{default:D(()=>[n(Be,{class:"q-mt-lg",onSubmit:Fe,onReset:ue},{default:D(()=>[n(xe,{collection:"pcf-media",onSelected:ge}),e.value.media.created_at&&e.value.media.updated_at?(r(),h(Me,{key:0,created_at:e.value.media.created_at,updated_at:e.value.media.updated_at,class:"q-my-md"},null,8,["created_at","updated_at"])):b("",!0),c("div",Ie,[c("div",Ae,[n($e,{size:"96px",rounded:"",onClick:ye},{default:D(()=>{var a;return[c("img",{src:(a=e.value.media.poster)==null?void 0:a.url},null,8,Le)]}),_:1})]),c("div",Ye,[n(B(me),{ref_key:"posterPicker",ref:K,dense:"",class:"q-mb-md",outlined:"",modelValue:_.value.poster,"onUpdate:modelValue":l[0]||(l[0]=a=>_.value.poster=a),label:"load poster",accept:"image/*",onFocus:R},{append:D(()=>[_.value.poster!==null?(r(),h(M,{key:0,name:B(G),onClick:Y(oe,["stop","prevent"]),class:"cursor-pointer"},null,8,["name"])):(r(),h(S,{key:1,round:"",dense:"",flat:"",icon:"folder_open"}))]),_:1},8,["modelValue"]),e.value.media.poster?(r(),h(V,{key:0,modelValue:e.value.media.poster.url,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.media.poster.url=a),outlined:"",label:"poster url",hint:"",dense:"","lazy-rules":"",onFocus:R,onBlur:j,rules:[a=>a.length>=0||"Please type something"]},{append:D(()=>[_.value.poster||!e.value.media.poster.url?(r(),h(S,{key:0,round:"",dense:"",flat:"",icon:"restart_alt",onClick:qe})):b("",!0),e.value.media.poster.url?(r(),h(M,{key:1,name:B(G),onClick:Y(oe,["stop","prevent"]),class:"cursor-pointer"},null,8,["name"])):b("",!0)]),_:1},8,["modelValue","rules"])):b("",!0)])]),c("div",Ge,[n(V,{class:"col-6 q-pr-sm",modelValue:e.value.media.name,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.media.name=a),label:"name",outlined:"",dense:"",clearable:"","lazy-rules":"",onFocus:R,onBlur:j,rules:[a=>a.length>0||"Please type something"]},null,8,["modelValue","rules"]),n(V,{class:"col-6 q-pl-sm",modelValue:e.value.media.producer,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.media.producer=a),label:"producer",hint:"",outlined:"",dense:"",clearable:"","lazy-rules":"",rules:[a=>a.length>0||"Please type something"]},null,8,["modelValue","rules"])]),c("div",He,[n(V,{class:"col-6 q-pr-sm",modelValue:e.value.media.alias,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.media.alias=a),label:"alias",hint:"",outlined:"",clearable:"",dense:"","lazy-rules":"",onFocus:R,onBlur:j,rules:[a=>a.length>0||"Please type something"]},null,8,["modelValue","rules"]),n(de,{class:"col-6 q-pl-sm",outlined:"",modelValue:e.value.media.category,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.media.category=a),options:B(Te),dense:"","options-dense":!1,"hide-dropdown-icon":"",label:"category","stack-label":""},{append:D(()=>[n(M,{name:Z.value},null,8,["name"])]),_:1},8,["modelValue","options"])]),c("div",Ke,[n(V,{class:"col-6 q-pr-sm",outlined:"",type:"number",clearable:"",label:"duration",hint:"",modelValue:e.value.media.duration,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.media.duration=a),modelModifiers:{number:!0},onFocus:R,onBlur:j,dense:"","lazy-rules":"",rules:[a=>a>0||"Please type something"]},null,8,["modelValue","rules"]),n(de,{class:"col-6 q-pl-sm",outlined:"",modelValue:C.value,"onUpdate:modelValue":l[7]||(l[7]=a=>C.value=a),options:B(Qe),dense:"","options-dense":!1,"hide-dropdown-icon":"",label:"language","stack-label":""},{append:D(()=>[n(M,{name:Q.value},null,8,["name"])]),_:1},8,["modelValue","options"])]),T.value?(r(),f("div",Ze,[(r(!0),f(O,null,ee(e.value.media.speed,(a,u)=>(r(),f(O,{key:u},[c("div",We,[n(V,{class:"col-6 q-pa-none q-py-sm q-pr-sm",label:"start",outlined:"",modelValue:a.start,"onUpdate:modelValue":s=>a.start=s,dense:"",onFocus:s=>I(u),onBlur:s=>A(u),clearable:"","lazy-rules":"",rules:[s=>/^\d+\.[1-4]\.[1-4]$/.test(s)||/^\d+\.[1-4]$/.test(s)&&Number(s)>1||/^\d+$/.test(s)&&Number(s)>0||"1 or 1.2 or 1.2.3"]},null,8,["modelValue","onUpdate:modelValue","onFocus","onBlur","rules"]),n(V,{class:"col-6 q-pa-none q-py-sm q-pl-sm",label:"time signature",outlined:"",modelValue:a.time_signature,"onUpdate:modelValue":s=>a.time_signature=s,dense:"",onFocus:s=>I(u),onBlur:s=>A(u),clearable:"","lazy-rules":"",rules:[s=>s.length>=0||"Please type something"]},null,8,["modelValue","onUpdate:modelValue","onFocus","onBlur","rules"]),n(V,{class:"col-6 q-pa-none q-py-sm q-pr-sm",label:"end",outlined:"",modelValue:a.end,"onUpdate:modelValue":s=>a.end=s,dense:"",onFocus:s=>I(u),onBlur:s=>A(u),clearable:"","lazy-rules":"",rules:[s=>/^\d+\.[1-4]\.[1-4]$/.test(s)||/^\d+\.[1-4]$/.test(s)&&Number(s)>1||/^\d+$/.test(s)&&Number(s)>0||"1 or 1.2 or 1.2.3"]},null,8,["modelValue","onUpdate:modelValue","onFocus","onBlur","rules"]),n(V,{class:"col-6 q-pa-none q-py-sm q-pl-sm",modelValue:a.tempo,"onUpdate:modelValue":s=>a.tempo=s,type:"text",label:"tempo",onFocus:s=>I(u),onBlur:s=>A(u),outlined:"",clearable:"",dense:"","lazy-rules":"",rules:[s=>s>=0||"Please type something"]},null,8,["modelValue","onUpdate:modelValue","onFocus","onBlur","rules"])]),e.value.media.speed&&u<e.value.media.speed.length-1?(r(),h(ie,{key:0,class:"q-mb-sm"})):b("",!0)],64))),128))])):b("",!0),c("div",Xe,[n(ne,{class:"col-6 q-pr-sm",label:`Speed ${T.value?"ON":"OFF"}`,modelValue:T.value,"onUpdate:modelValue":l[8]||(l[8]=a=>T.value=a)},null,8,["label","modelValue"]),n(ne,{class:"col-6 q-pl-sm",label:`Params ${J.value?"ON":"OFF"}`,modelValue:J.value,"onUpdate:modelValue":l[9]||(l[9]=a=>J.value=a)},null,8,["label","modelValue"])]),J.value&&t.value.video?(r(),f("div",ea,[c("video",aa,[c("source",{src:fe.value,type:"audio/x-mpegurl"},null,8,la),ae(" \u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301 video \u6807\u7B7E\u3002 ")])])):b("",!0),J.value?(r(),f("div",oa,[t.value.audio||t.value.video?(r(),f("div",sa,[c("div",ua,[(r(!0),f(O,null,ee(t.value.files,(a,u)=>(r(),f(O,{key:u},[a?(r(),f("div",ta,[n(re,{dense:"",class:"col-5 q-px-sm",label:a.type.split("/").pop(),outline:"",rounded:"",color:"grey-5"},null,8,["label"]),n(re,{dense:"",class:"col-6 q-px-sm",label:a.size,outline:"",rounded:"",color:"grey-6"},null,8,["label"])])):b("",!0)],64))),128))]),n(V,{class:"col-4 q-pa-none",label:"Time",outlined:"",clearable:"",modelValue:t.value.currentTime,"onUpdate:modelValue":l[10]||(l[10]=a=>t.value.currentTime=a),dense:"","lazy-rules":"",rules:[a=>a.length>=0||"Time format, 12, 1:23, or 1:23:45"]},null,8,["modelValue","rules"]),c("div",ia,[n(S,{color:"primary",icon:t.value.isPlaying?"pause":"play_arrow",dense:"",outline:"",round:"",onClick:he},null,8,["icon"]),n(S,{dense:"",outline:"",color:"primary",icon:"stop",round:"",onClick:Ve})])])):b("",!0),(r(!0),f(O,null,ee(e.value.media.params,(a,u)=>(r(),f(O,{key:u},[a.url?(r(),f("div",na,[a.type.includes("audio")?(r(),f("div",da,[c("audio",ra,[c("source",{src:a.url,type:a.type},null,8,ma),ae(" \u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301 audio \u6807\u7B7E\u3002 ")])])):a.type.includes("video")?(r(),f("div",pa,[c("video",ca,[c("source",{src:a.url,type:a.type},null,8,va),ae(" \u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301 video \u6807\u7B7E\u3002 ")])])):a.type.includes("image")?(r(),f("div",fa,[n(De,{src:a.url},null,8,["src"])])):(r(),f("div",ya," \u60A8\u52A0\u8F7D\u7684\u6587\u4EF6\u4E0D\u662F\u5A92\u4F53\u6587\u4EF6\u7C7B\u578B (audio, video, image) "))])):b("",!0),c("div",ga,[n(B(me),{class:"col-12 q-py-sm",modelValue:a.file,"onUpdate:modelValue":[s=>a.file=s,_e],label:"load media file",accept:"video/*, audio/*, image/*",outlined:"",dense:"",onFocus:s=>L(u)},{append:D(()=>[a.file?(r(),h(M,{key:0,name:B(G),onClick:Y(se,["stop","prevent"]),class:"cursor-pointer"},null,8,["name"])):(r(),h(S,{key:1,round:"",dense:"",flat:"",icon:"folder_open"}))]),_:2},1032,["modelValue","onUpdate:modelValue","onFocus"]),n(V,{class:"col-12 q-pa-none q-py-sm",modelValue:a.url,"onUpdate:modelValue":[s=>a.url=s,s=>be(u)],label:"media url",hint:"",outlined:"",dense:"","lazy-rules":"",onFocus:s=>L(u),onBlur:s=>W(u),rules:[s=>s.length>=0||"Please type something"]},{append:D(()=>[a.file||!a.url?(r(),h(S,{key:0,round:"",dense:"",flat:"",icon:"restart_alt",onClick:we})):b("",!0),a.url?(r(),h(M,{key:1,name:B(G),onClick:Y(se,["stop","prevent"])},null,8,["name"])):b("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","onFocus","onBlur","rules"]),n(V,{class:"col-6 q-pa-none q-py-sm q-pr-sm",label:"ffplay",outlined:"",clearable:"",modelValue:a.ffplay,"onUpdate:modelValue":s=>a.ffplay=s,onFocus:s=>L(u),onBlur:s=>W(u),dense:"","lazy-rules":"",rules:[s=>s.length>=0||"ffplay options: -t 30"]},null,8,["modelValue","onUpdate:modelValue","onFocus","onBlur","rules"]),n(V,{class:"col-6 q-pa-none q-py-sm q-pl-sm",label:"ffmpeg",type:"number",modelValue:a.ffmpeg,"onUpdate:modelValue":s=>a.ffmpeg=s,modelModifiers:{number:!0},clearable:"",onFocus:s=>L(u),onBlur:s=>W(u),dense:"","lazy-rules":"",outlined:"",rules:[s=>s>=0||"ffmpeg options: "]},null,8,["modelValue","onUpdate:modelValue","onFocus","onBlur","rules"])]),e.value.media.params&&u<e.value.media.params.length-1?(r(),h(ie,{key:1,class:"q-mb-sm"})):b("",!0)],64))),128))])):b("",!0),c("div",ba,[q.value=="Update"||["speed","params"].includes(y.value)?(r(),f(O,{key:0},[n(S,{dense:"",outline:"",color:"negative",icon:"add",round:"",onClick:Ue}),n(S,{dense:"",outline:"",color:"negative",icon:"remove",round:"",onClick:ke})],64)):b("",!0),n(S,{class:"q-px-md",dense:"","no-caps":"",unelevated:"",label:"Reset",type:"reset",color:"primary",icon:"restart_alt",outline:"",rounded:""}),n(S,{class:"q-px-md",dense:"",outline:"","no-caps":"",unelevated:"",label:q.value,type:"submit",color:"primary",icon:"cloud_upload",rounded:""},null,8,["label"])])]),_:1})]),_:1}))}});export{Ia as default};
