import{Q as N}from"./QToolbarTitle.5e2b8a84.js";import{_ as z,d as O,u as T,k as U,r as b,l as j,m as i,n as C,p as a,j as o,q as Q,t as E,s as p,Q as q,v as r,f as G,x as L,y as H,z as J,A as B,B as A,F as I,C as M,D as K,E as F,G as W,H as x,I as X,J as Y}from"./index.4f390c6a.js";import{Q as Z}from"./QItemLabel.95b24a48.js";import{Q as ee}from"./QList.423862dd.js";import{Q as oe}from"./QBtnDropdown.38ff8e37.js";import{Q as le}from"./QToolbar.582a7924.js";import{Q as ae,a as te,b as se}from"./QLayout.1bc9c1a4.js";import{Q as ue}from"./QForm.c09e6959.js";import{Q as ne}from"./QPage.e32daf6c.js";import{C as re}from"./ClosePopup.14229a43.js";import{u as ie}from"./use-quasar.4e14d354.js";import{l as de}from"./locale-options.a93a5ee4.js";import{p as h,a as fe,b as ce}from"./cloudDB.d318324a.js";import{u as S}from"./vue-i18n.runtime.b0371a81.js";import"./QMenu.75c03351.js";import"./selection.1482bdb7.js";import"./QResizeObserver.cb7e3544.js";import"./QScrollObserver.ad751985.js";import"./axios.ea5872bc.js";import"./constant.a3c7e21e.js";const P=v=>(X("data-v-1fe9f083"),v=v(),Y(),v),pe={class:"q-pa-sm"},me=P(()=>p("img",{src:"profile.svg"},null,-1)),ge=P(()=>p("div",{class:"text-center q-pt-lg"},[p("p",null,"\u7BA1\u7406\u8005")],-1)),ve=O({__name:"LoginPage",setup(v){const u=T(),_=U(),{locale:d}=S({useScope:"global"}),{t:V}=S(),f=b(""),c=b(""),y=b(!1),m=b(!1),s=ie();d.value=s.lang.isoName,s.dark.isActive=!1;let n=[],g,k;j(async()=>{if(console.log("Login route.query: ",u.query),console.log("locale:",s.lang.getLocale()),console.log("$t:",V("user_info.name")),u.query.lastPath){if(g=u.query.lastPath,u.query.currentSeg&&(k=u.query.currentSeg),u.query.display==="form")n=s.localStorage.getItem("__QPCF_LOCAL_LOGIN_USER_INFO"),console.log("usersInfo: ",n),f.value=n[0].name,c.value=n[0].password,m.value=!0;else if(u.query.display==="banner"){m.value=!1;const l=await h();l!=null&&l.info?(console.log("login back route.query.lastPath:",u.query.lastPath),_.push({path:g,query:{notify:l.info.name}})):m.value=!0}}else{if(console.log("\u542F\u52A8\u76F4\u63A5\u8FDB\u5165 LoginPage"),await fe()){const l=await h();if(!(l!=null&&l.info)){m.value=!0;return}}_.replace({path:"/tabs/tab1"})}});async function D(){const l=n.findIndex(w=>w.name===f.value&&w.password===c.value),t=l>=0?n[l]:{name:f.value,password:c.value},e=await h(t);console.log("Login onLogin result:",e),e!=null&&e.info?(console.log("Login onLogin result.info:",e.info),console.log("Login onLogin route.query:",u.query),console.log("Login onLogin currentSeg:",k),g&&(console.log("onLogin lastPath:",g),_.push({path:g,query:{currentSeg:k}}))):s.notify({message:(e==null?void 0:e.res.error.message)||"Login Error",caption:"5 minutes ago",color:"secondary"})}function $(l=!1){const t=[];for(const e of n)t.push({label:e.name,img:"https://cdn.quasar.dev/img/logo_drive_128px.png",id:e.uid,password:e.password});s.bottomSheet({title:"\u8D26\u53F7\u5217\u8868",message:"\u8BF7\u70B9\u51FB\u4E0B\u9762\u7684\u4E00\u4E2A\u7528\u6237\u540D",grid:l,actions:t}).onOk(e=>{f.value=e.label,c.value=e.password}).onCancel(()=>{console.log("Dismissed")}).onDismiss(()=>{})}async function R(){const l=await ce();l.info?_.replace({path:"/tabs/tab1"}):l.res?console.log("onAutoRegister Error: ",l.res):console.log("onAutoRegister Fail: check network.")}return(l,t)=>(i(),C(ae,null,{default:a(()=>[o(te,{elevated:""},{default:a(()=>[o(le,{dense:""},{default:a(()=>[o(N,null,{default:a(()=>[Q(E(l.$t("login.title")),1)]),_:1}),p("div",null,[o(q,{dense:"",flat:"",round:"",onClick:t[0]||(t[0]=e=>r(s).dark.toggle()),color:r(s).dark.isActive?"black":"white",icon:r(s).dark.isActive?"nights_stay":"wb_sunny"},null,8,["color","icon"])]),p("div",pe,[o(oe,{rounded:"",color:"light","dropdown-icon":"language",flat:"",dense:""},{default:a(()=>[o(ee,{modelValue:r(d),"onUpdate:modelValue":t[1]||(t[1]=e=>G(d)?d.value=e:null)},{default:a(()=>[(i(!0),L(I,null,H(r(de),e=>J((i(),C(B,{key:e.label,active:e.value==r(d),clickable:"",onClick:w=>d.value=e.value},{default:a(()=>[o(A,null,{default:a(()=>[o(Z,null,{default:a(()=>[Q(E(e.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["active","onClick"])),[[re]])),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1})]),_:1}),o(se,null,{default:a(()=>[o(ne,{class:"flex bg-image flex-center"},{default:a(()=>[m.value?(i(),C(M,{key:0,style:K(r(s).screen.lt.sm?{width:"80%"}:{width:"30%"})},{default:a(()=>[o(F,null,{default:a(()=>[o(W,{size:"103px",class:"absolute-center shadow-10"},{default:a(()=>[me]),_:1})]),_:1}),o(F,null,{default:a(()=>[ge]),_:1}),o(F,null,{default:a(()=>[o(ue,{class:"q-gutter-md"},{default:a(()=>[o(x,{outlined:"",modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=e=>f.value=e),label:l.$t("user_info.name"),clearable:"","lazy-rules":""},null,8,["modelValue","label"]),o(x,{type:y.value?"text":"password",outlined:"",modelValue:c.value,"onUpdate:modelValue":t[4]||(t[4]=e=>c.value=e),label:l.$t("user_info.password"),"lazy-rules":"",clearable:""},{append:a(()=>[o(q,{flat:"",round:"",dense:"",icon:y.value?"visibility":"visibility_off",onClick:t[3]||(t[3]=e=>y.value=!y.value)},null,8,["icon"])]),_:1},8,["type","modelValue","label"]),p("div",null,[o(q,{class:"full-width",label:l.$t("login.login"),type:"button",color:"primary",onClick:D},null,8,["label"])])]),_:1}),r(n).length>1?(i(),L("div",{key:0,class:"q-mt-md flex justify-end text-blue-8",onClick:t[5]||(t[5]=e=>$())}," \u5207\u6362\u8D26\u53F7 ")):(i(),L("div",{key:1,class:"q-mt-md flex justify-end text-blue-8",onClick:t[6]||(t[6]=e=>R())}," \u81EA\u52A8\u6CE8\u518C "))]),_:1})]),_:1},8,["style"])):(i(),L(I,{key:1},[o(B,null,{default:a(()=>[o(A,null,{default:a(()=>[Q(" \u4E92\u52A8\u55B7\u6CC9 Logo ")]),_:1})]),_:1}),o(B,null,{default:a(()=>[o(A,null,{default:a(()=>[Q(" \u6E38\u5BA2\u6B63\u5728\u767B\u5F55... \u6E38\u5BA2\u767B\u5F55\u6210\u529F\u3002 \u6E38\u5BA2\u767B\u5F55\u5931\u8D25\u3002\u663E\u793A\u5927\u81F4\u539F\u56E0\u3002 ")]),_:1})]),_:1})],64))]),_:1})]),_:1})]),_:1}))}});var $e=z(ve,[["__scopeId","data-v-1fe9f083"]]);export{$e as default};
