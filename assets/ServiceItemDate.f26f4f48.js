import{K as ze,M as Le,a$ as Ue,N as We,bm as Xe,r as I,c,w as ge,ay as Ge,L as Je,h as s,g as Ze,bl as Re,a7 as et,aD as tt,z as ce,Q as M,a9 as lt,d as ut,m as G,n as J,p as _,A as at,j as k,q as pe,t as De,B as Z,s as be,v as B,aT as re,bb as nt}from"./index.4f390c6a.js";import{T as ot}from"./TouchPan.5282a72c.js";import{u as it,a as st,b as rt,g as ct,Q as we,c as dt}from"./QDate.3db3b100.js";import{_ as R,f as vt,d as A}from"./date.865a2574.js";import{p as q}from"./format.6396bb17.js";import{C as qe}from"./ClosePopup.14229a43.js";import{u as mt}from"./vue-i18n.runtime.b0371a81.js";function ft(l,C){if(l.hour!==null){if(l.minute===null)return"minute";if(C===!0&&l.second===null)return"second"}return"hour"}function ht(){const l=new Date;return{hour:l.getHours(),minute:l.getMinutes(),second:l.getSeconds(),millisecond:l.getMilliseconds()}}var _t=ze({name:"QTime",props:{...Le,...Ue,...it,mask:{default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:l=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(l)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:st,setup(l,{slots:C,emit:ee}){const x=Ze(),{$q:p}=x.proxy,f=We(l,p),{tabindex:g,headerClass:T,getLocale:te,getCurrentDate:D}=rt(l,p),w=Xe(l),S=Re(w);let P,K;const de=I(null),N=c(()=>Ye()),Q=c(()=>te()),ve=c(()=>He()),$=R(l.modelValue,N.value,Q.value,l.calendar,ve.value),i=I(ft($)),u=I($),d=I($.hour===null||$.hour<12),Me=c(()=>`q-time q-time--${l.landscape===!0?"landscape":"portrait"}`+(f.value===!0?" q-time--dark q-dark":"")+(l.disable===!0?" disabled":l.readonly===!0?" q-time--readonly":"")+(l.bordered===!0?" q-time--bordered":"")+(l.square===!0?" q-time--square no-border-radius":"")+(l.flat===!0?" q-time--flat no-shadow":"")),le=c(()=>{const e=u.value;return{hour:e.hour===null?"--":m.value===!0?q(e.hour):String(d.value===!0?e.hour===0?12:e.hour:e.hour>12?e.hour-12:e.hour),minute:e.minute===null?"--":q(e.minute),second:e.second===null?"--":q(e.second)}}),m=c(()=>l.format24h!==null?l.format24h:p.lang.date.format24h),Ce=c(()=>{const e=i.value==="hour",t=e===!0?12:60,a=u.value[i.value];let r=`rotate(${Math.round(a*(360/t))-180}deg) translateX(-50%)`;return e===!0&&m.value===!0&&u.value.hour>=12&&(r+=" scale(.7)"),{transform:r}}),me=c(()=>u.value.hour!==null),xe=c(()=>me.value===!0&&u.value.minute!==null),V=c(()=>l.hourOptions!==void 0?e=>l.hourOptions.includes(e):l.options!==void 0?e=>l.options(e,null,null):null),F=c(()=>l.minuteOptions!==void 0?e=>l.minuteOptions.includes(e):l.options!==void 0?e=>l.options(u.value.hour,e,null):null),j=c(()=>l.secondOptions!==void 0?e=>l.secondOptions.includes(e):l.options!==void 0?e=>l.options(u.value.hour,u.value.minute,e):null),y=c(()=>{if(V.value===null)return null;const e=z(0,11,V.value),t=z(12,11,V.value);return{am:e,pm:t,values:e.values.concat(t.values)}}),Y=c(()=>F.value!==null?z(0,59,F.value):null),H=c(()=>j.value!==null?z(0,59,j.value):null),E=c(()=>{switch(i.value){case"hour":return y.value;case"minute":return Y.value;case"second":return H.value}}),Se=c(()=>{let e,t,a=0,o=1;const r=E.value!==null?E.value.values:void 0;i.value==="hour"?m.value===!0?(e=0,t=23):(e=0,t=11,d.value===!1&&(a=12)):(e=0,t=55,o=5);const h=[];for(let n=e,v=e;n<=t;n+=o,v++){const b=n+a,je=r!==void 0&&r.includes(b)===!1,Ee=i.value==="hour"&&n===0?m.value===!0?"00":"12":n;h.push({val:b,index:v,disable:je,label:Ee})}return h}),Ve=c(()=>[[ot,Oe,void 0,{stop:!0,prevent:!0,mouse:!0}]]);ge(()=>l.modelValue,e=>{const t=R(e,N.value,Q.value,l.calendar,ve.value);(t.dateHash!==u.value.dateHash||t.timeHash!==u.value.timeHash)&&(u.value=t,t.hour===null?i.value="hour":d.value=t.hour<12)}),ge([N,Q],()=>{lt(()=>{se()})});function fe(){const e={...D(),...ht()};se(e),Object.assign(u.value,e),i.value="hour"}function z(e,t,a){const o=Array.apply(null,{length:t+1}).map((r,h)=>{const n=h+e;return{index:n,val:a(n)===!0}}).filter(r=>r.val===!0).map(r=>r.index);return{min:o[0],max:o[o.length-1],values:o,threshold:t+1}}function he(e,t,a){const o=Math.abs(e-t);return Math.min(o,a-o)}function ue(e,{min:t,max:a,values:o,threshold:r}){if(e===t)return t;if(e<t||e>a)return he(e,t,r)<=he(e,a,r)?t:a;const h=o.findIndex(b=>e<=b),n=o[h-1],v=o[h];return e-n<=v-e?n:v}function Ye(){return l.calendar!=="persian"&&l.mask!==null?l.mask:`HH:mm${l.withSeconds===!0?":ss":""}`}function He(){if(typeof l.defaultDate!="string"){const e=D(!0);return e.dateHash=ct(e),e}return R(l.defaultDate,"YYYY/MM/DD",void 0,l.calendar)}function ae(){return et(x)===!0||E.value!==null&&(E.value.values.length===0||i.value==="hour"&&m.value!==!0&&y.value[d.value===!0?"am":"pm"].values.length===0)}function ne(){const e=de.value,{top:t,left:a,width:o}=e.getBoundingClientRect(),r=o/2;return{top:t+r,left:a+r,dist:r*.7}}function Oe(e){if(ae()!==!0){if(e.isFirst===!0){P=ne(),K=L(e.evt,P);return}K=L(e.evt,P,K),e.isFinal===!0&&(P=!1,K=null,_e())}}function _e(){i.value==="hour"?i.value="minute":l.withSeconds&&i.value==="minute"&&(i.value="second")}function L(e,t,a){const o=Ge(e),r=Math.abs(o.top-t.top),h=Math.sqrt(Math.pow(Math.abs(o.top-t.top),2)+Math.pow(Math.abs(o.left-t.left),2));let n,v=Math.asin(r/h)*(180/Math.PI);if(o.top<t.top?v=t.left<o.left?90-v:270+v:v=t.left<o.left?v+90:270-v,i.value==="hour"){if(n=v/30,y.value!==null){const b=m.value!==!0?d.value===!0:y.value.am.values.length!==0&&y.value.pm.values.length!==0?h>=t.dist:y.value.am.values.length!==0;n=ue(n+(b===!0?0:12),y.value[b===!0?"am":"pm"])}else n=Math.round(n),m.value===!0?h<t.dist?n<12&&(n+=12):n===12&&(n=0):d.value===!0&&n===12?n=0:d.value===!1&&n!==12&&(n+=12);m.value===!0&&(d.value=n<12)}else n=Math.round(v/6)%60,i.value==="minute"&&Y.value!==null?n=ue(n,Y.value):i.value==="second"&&H.value!==null&&(n=ue(n,H.value));return a!==n&&Qe[i.value](n),n}const oe={hour(){i.value="hour"},minute(){i.value="minute"},second(){i.value="second"}};function Be(e){e.keyCode===13&&ye()}function Ae(e){e.keyCode===13&&ke()}function Ie(e){ae()!==!0&&(p.platform.is.desktop!==!0&&L(e,ne()),_e())}function Te(e){ae()!==!0&&L(e,ne())}function Pe(e){if(e.keyCode===13)i.value="hour";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(y.value!==null){const a=m.value===!0?y.value.values:y.value[d.value===!0?"am":"pm"].values;if(a.length===0)return;if(u.value.hour===null)U(a[0]);else{const o=(a.length+a.indexOf(u.value.hour)+t)%a.length;U(a[o])}}else{const a=m.value===!0?24:12,o=m.value!==!0&&d.value===!1?12:0,r=u.value.hour===null?-t:u.value.hour;U(o+(24+r+t)%a)}}}function Ke(e){if(e.keyCode===13)i.value="minute";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(Y.value!==null){const a=Y.value.values;if(a.length===0)return;if(u.value.minute===null)W(a[0]);else{const o=(a.length+a.indexOf(u.value.minute)+t)%a.length;W(a[o])}}else{const a=u.value.minute===null?-t:u.value.minute;W((60+a+t)%60)}}}function Ne(e){if(e.keyCode===13)i.value="second";else if([37,39].includes(e.keyCode)){const t=e.keyCode===37?-1:1;if(H.value!==null){const a=H.value.values;if(a.length===0)return;if(u.value.seconds===null)X(a[0]);else{const o=(a.length+a.indexOf(u.value.second)+t)%a.length;X(a[o])}}else{const a=u.value.second===null?-t:u.value.second;X((60+a+t)%60)}}}function U(e){u.value.hour!==e&&(u.value.hour=e,O())}function W(e){u.value.minute!==e&&(u.value.minute=e,O())}function X(e){u.value.second!==e&&(u.value.second=e,O())}const Qe={hour:U,minute:W,second:X};function ye(){d.value===!1&&(d.value=!0,u.value.hour!==null&&(u.value.hour-=12,O()))}function ke(){d.value===!0&&(d.value=!1,u.value.hour!==null&&(u.value.hour+=12,O()))}function ie(e){const t=l.modelValue;i.value!==e&&t!==void 0&&t!==null&&t!==""&&typeof t!="string"&&(i.value=e)}function O(){if(V.value!==null&&V.value(u.value.hour)!==!0){u.value=R(),ie("hour");return}if(F.value!==null&&F.value(u.value.minute)!==!0){u.value.minute=null,u.value.second=null,ie("minute");return}if(l.withSeconds===!0&&j.value!==null&&j.value(u.value.second)!==!0){u.value.second=null,ie("second");return}u.value.hour===null||u.value.minute===null||l.withSeconds===!0&&u.value.second===null||se()}function se(e){const t=Object.assign({...u.value},e),a=l.calendar==="persian"?q(t.hour)+":"+q(t.minute)+(l.withSeconds===!0?":"+q(t.second):""):vt(new Date(t.year,t.month===null?null:t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),N.value,Q.value,t.year,t.timezoneOffset);t.changed=a!==l.modelValue,ee("update:modelValue",a,t)}function $e(){const e=[s("div",{class:"q-time__link "+(i.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:oe.hour,onKeyup:Pe},le.value.hour),s("div",":"),s("div",me.value===!0?{class:"q-time__link "+(i.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:Ke,onClick:oe.minute}:{class:"q-time__link"},le.value.minute)];l.withSeconds===!0&&e.push(s("div",":"),s("div",xe.value===!0?{class:"q-time__link "+(i.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onKeyup:Ne,onClick:oe.second}:{class:"q-time__link"},le.value.second));const t=[s("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},e)];return m.value===!1&&t.push(s("div",{class:"q-time__header-ampm column items-between no-wrap"},[s("div",{class:"q-time__link "+(d.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:ye,onKeyup:Be},"AM"),s("div",{class:"q-time__link "+(d.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:g.value,onClick:ke,onKeyup:Ae},"PM")])),s("div",{class:"q-time__header flex flex-center no-wrap "+T.value},t)}function Fe(){const e=u.value[i.value];return s("div",{class:"q-time__content col relative-position"},[s(tt,{name:"q-transition--scale"},()=>s("div",{key:"clock"+i.value,class:"q-time__container-parent absolute-full"},[s("div",{ref:de,class:"q-time__container-child fit overflow-hidden"},[ce(s("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:Ie,onMousedown:Te},[s("div",{class:"q-time__clock-circle fit"},[s("div",{class:"q-time__clock-pointer"+(u.value[i.value]===null?" hidden":l.color!==void 0?` text-${l.color}`:""),style:Ce.value}),Se.value.map(t=>s("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${t.index}`+(t.val===e?" q-time__clock-position--active "+T.value:t.disable===!0?" q-time__clock-position--disable":"")},[s("span",t.label)]))])]),Ve.value)])])),l.nowBtn===!0?s(M,{class:"q-time__now-button absolute",icon:p.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:l.color,textColor:l.textColor,tabindex:g.value,onClick:fe}):null])}return x.proxy.setNow=fe,()=>{const e=[Fe()],t=Je(C.default);return t!==void 0&&e.push(s("div",{class:"q-time__actions"},t)),l.name!==void 0&&l.disable!==!0&&S(e,"push"),s("div",{class:Me.value,tabindex:-1},[$e(),s("div",{class:"q-time__main col overflow-auto"},e)])}}});const yt={class:"row items-center justify-end"},kt={class:"row items-center justify-end"},Ct=ut({__name:"ServiceItemDate",props:{title:{default:""},date_value:{},isDate:{type:Boolean,default:!0},isTime:{type:Boolean,default:!1},isWeekday:{type:Boolean,default:!1}},emits:["update:date_value"],setup(l,{emit:C}){const ee=l,{t:x}=mt(),p=x,f=I(A.formatDate(ee.date_value,"YYYY/MM/DD H:mm")),g=C;function T(){g("update:date_value",f.value)}function te(){f.value=A.formatDate(Date.now(),"YYYY/MM/DD H:mm")}return(D,w)=>(G(),J(at,{class:"q-my-sm"},{default:_(()=>[k(Z,{avatar:""},{default:_(()=>[pe(De(D.title)+" ",1)]),_:1}),D.isTime?(G(),J(Z,{key:0,class:"",avatar:""},{default:_(()=>[k(M,{class:"",flat:"",size:"16px",color:"primary",label:B(A).formatDate(f.value,"H : mm")},{default:_(()=>[k(we,{onBeforeShow:T,cover:"","transition-show":"scale","transition-hide":"scale"},{default:_(()=>[k(_t,{modelValue:f.value,"onUpdate:modelValue":w[0]||(w[0]=S=>f.value=S),mask:"YYYY/MM/DD H:mm",format24h:""},{default:_(()=>[be("div",yt,[ce(k(M,{label:"\u5173\u95ED",color:"primary",outline:""},null,512),[[qe]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"])]),_:1})):re("",!0),D.isDate?(G(),J(Z,{key:1,class:""},{default:_(()=>[k(M,{class:"",flat:"",size:"16px",color:"primary",label:B(A).formatDate(f.value,"YYYY \u5E74 M \u6708 D \u65E5")},{default:_(()=>[k(we,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:_(()=>[k(B(dt),{modelValue:f.value,"onUpdate:modelValue":w[1]||(w[1]=S=>f.value=S),mask:"YYYY/MM/DD H:mm","today-btn":""},{default:_(()=>[be("div",kt,[k(M,{class:"q-mr-md",label:"\u4ECA\u5929",color:"primary",outline:"",onClick:nt(te,["stop"])}),ce(k(M,{label:"\u5173\u95ED",color:"primary",outline:""},null,512),[[qe]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"])]),_:1})):re("",!0),D.isWeekday?(G(),J(Z,{key:2,class:"",side:""},{default:_(()=>[pe(De(B(p)("weekdays").split(",")[Number(B(A).formatDate(f.value,"E"))-1]),1)]),_:1})):re("",!0)]),_:1}))}});export{Ct as _};
